@model TimeTrackerApp.Models.Client

@{
    ViewData["Title"] = "Szczeg贸y klienta";
}

<div style="margin-top: 2rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <div>
            <h2 style="margin: 0;">@Model.Name</h2>
            <p class="hint" style="margin-top: 0.5rem;">Szczeg贸owe informacje o kliencie</p>
        </div>
        <div style="display: flex; gap: 0.5rem;">
            <a asp-action="Report" asp-route-id="@Model.Id" class="btn btn-primary"> Raport</a>
            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-secondary">Edytuj</a>
            <a asp-action="Index" class="btn btn-secondary">Powr贸t</a>
        </div>
    </div>

    <div class="card" style="margin-bottom: 2rem;">
        <h3 style="margin-bottom: 1.5rem;">Dane klienta</h3>
        
        <dl style="display: grid; grid-template-columns: 200px 1fr; gap: 1rem;">
            <dt style="font-weight: 600; color: var(--text-secondary);">Opis:</dt>
            <dd style="margin: 0;">@(Model.Description ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Email:</dt>
            <dd style="margin: 0;">
                @if (!string.IsNullOrEmpty(Model.Email))
                {
                    <a href="mailto:@Model.Email">@Model.Email</a>
                }
                else
                {
                    <span style="color: var(--text-tertiary);">(brak)</span>
                }
            </dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Telefon:</dt>
            <dd style="margin: 0;">
                @if (!string.IsNullOrEmpty(Model.Phone))
                {
                    <a href="tel:@Model.Phone">@Model.Phone</a>
                }
                else
                {
                    <span style="color: var(--text-tertiary);">(brak)</span>
                }
            </dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Adres:</dt>
            <dd style="margin: 0;">@(Model.Address ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Miasto:</dt>
            <dd style="margin: 0;">@(Model.City ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Kod pocztowy:</dt>
            <dd style="margin: 0;">@(Model.PostalCode ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Kraj:</dt>
            <dd style="margin: 0;">@(Model.Country ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">NIP:</dt>
            <dd style="margin: 0;">@(Model.NIP ?? "(brak)")</dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Status:</dt>
            <dd style="margin: 0;">
                @if (Model.IsActive)
                {
                    <span class="badge badge-success">Aktywny</span>
                }
                else
                {
                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 1rem; font-size: 0.8125rem; font-weight: 500; border-radius: 0.5rem; background: rgba(163, 163, 163, 0.1); color: var(--text-tertiary);">Nieaktywny</span>
                }
            </dd>

            <dt style="font-weight: 600; color: var(--text-secondary);">Data utworzenia:</dt>
            <dd style="margin: 0;">@Model.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>

            @if (Model.UpdatedAt.HasValue)
            {
                <dt style="font-weight: 600; color: var(--text-secondary);">Ostatnia aktualizacja:</dt>
                <dd style="margin: 0;">@Model.UpdatedAt.Value.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
            }
        </dl>
    </div>

    <div class="card">
        <h3 style="margin-bottom: 1.5rem;">Projekty klienta (@Model.Projects.Count)</h3>

        @if (Model.Projects.Any())
        {
            <table>
                <thead>
                    <tr>
                        <th>Nazwa projektu</th>
                        <th>Opiekun</th>
                        <th>Status</th>
                        <th>Data rozpoczcia</th>
                        <th>Aktywny</th>
                        <th style="text-align: center;">Akcje</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var project in Model.Projects.OrderByDescending(p => p.IsActive).ThenBy(p => p.Name))
                    {
                        <tr>
                            <td><strong>@project.Name</strong></td>
                            <td>@project.Manager.User.FirstName @project.Manager.User.LastName</td>
                            <td><span class="badge badge-secondary">@project.Status</span></td>
                            <td>@project.StartDate.ToString("yyyy-MM-dd")</td>
                            <td>
                                @if (project.IsActive)
                                {
                                    <span class="badge badge-success">Tak</span>
                                }
                                else
                                {
                                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 1rem; font-size: 0.8125rem; font-weight: 500; border-radius: 0.5rem; background: rgba(163, 163, 163, 0.1); color: var(--text-tertiary);">Nie</span>
                                }
                            </td>
                            <td style="text-align: center;">
                                <a asp-controller="Projects" asp-action="Details" asp-route-id="@project.Id" class="btn btn-secondary" style="font-size: 0.875rem; padding: 0.375rem 0.75rem;">Szczeg贸y</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <div style="text-align: center; padding: 2rem; color: var(--text-tertiary);">
                <p>Brak projekt贸w dla tego klienta.</p>
            </div>
        }
    </div>
</div>
